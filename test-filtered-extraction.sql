-- Test the filtered extraction query
SET LINESIZE 200

SELECT DISTINCT
    r.FORWARD_OBJECT_ID as PARENT_ID,
    p.OBJECT_ID as CHILD_ID,
    NVL(p.NAME_S_, 'Unnamed') as NAME
FROM DESIGN12.REL_COMMON r
INNER JOIN DESIGN12.PART_ p ON r.OBJECT_ID = p.OBJECT_ID
INNER JOIN DESIGN12.PART_ p2 ON r.FORWARD_OBJECT_ID = p2.OBJECT_ID
WHERE NOT EXISTS (SELECT 1 FROM DESIGN12.COLLECTION_ c WHERE c.OBJECT_ID = p.OBJECT_ID)
  AND p.OBJECT_ID IN (18208702, 18208714, 18208725, 18208734, 18209343, 18531240)
  AND r.FORWARD_OBJECT_ID IN (18208744, 18143953)
ORDER BY PARENT_ID, CHILD_ID;

EXIT
